---
tags:
- Technology/BA
- Difficulty/Intermediate
---
----
## Как эти механизмы разделяются в REST-сервисе с OAuth2/OpenID Connect
----
> [!FAQ]- Ответ
> - Для решения проблемы разделения механизмов в архитектуре RESTful необходимо четко различать аутентификацию, которая проверяет личность, и авторизацию, которая проверяет права доступа. OpenID Connect (OIDC) — это уровень идентификации, построенный на основе протокола OAuth 2.0 и специально разработанный для обработки аутентификации. В функциональном потоке OIDC генерирует токен идентификации (ID Token), содержащий утверждения о личности пользователя, такие как его имя или адрес электронной почты, эффективно отвечая на вопрос «кто этот пользователь». В свою очередь, базовая платформа OAuth 2.0 управляет авторизацией с помощью токенов доступа (Access Tokens), которые определяют конкретные области действия и разрешения, тем самым отвечая на вопрос «что пользователю разрешено делать» в отношении защищенных ресурсов.
> - С точки зрения технических требований, эти механизмы функционируют посредством обмена и проверки JSON Web Token (JWT). Когда клиентское приложение запрашивает доступ к REST-сервису, оно предоставляет токен доступа, обычно передаваемый в качестве токена Bearer в заголовке HTTP Authorization. Сервис на стороне сервера сначала проверяет подпись и срок действия токена, чтобы подтвердить, что он был выдан доверенным сервером авторизации; этот процесс проверки представляет собой компонент аутентификации. Одновременно сервис проверяет утверждения «scope» или «groups» в том же токене, чтобы определить, обладает ли клиент необходимыми привилегиями для выполнения конкретного метода API, такого как операция GET или POST, что составляет проверку авторизации.
> - В своем опыте сбора нефункциональных требований безопасности я обеспечиваю явное документирование этого разделения, сопоставляя роли пользователей с конкретными областями действия OAuth, а не смешивая их с атрибутами идентификации. Например, в недавнем проекте, связанном с многопользовательским API, я определил матрицу отслеживания требований, где поток OIDC обрабатывал единую систему аутентификации (SSO), а конечные точки REST строго обеспечивали контроль доступа на основе ролей (RBAC) на основе областей действия OAuth2. Такой подход гарантирует, что API остается без сохранения состояния и безопасным, поскольку сервис полностью полагается на проверенные утверждения, присутствующие в токене, а не запрашивает базу данных пользователей для каждого запроса.