---
tags:
- Technology/BA
- Difficulty/Intermediate
---
----
## Как в рамках аналитической платформы вы спроектируете data mart для витрины продаж (grain, источники, обновление), и какой SQL-запрос (SELECT с агрегациями) вы используете для получения KPI за период
----
> [!FAQ]- Ответ
> - Для проектирования надежного хранилища данных для панели управления продажами я бы использовал подход к многомерному моделированию, в частности, схему «звезда», чтобы сбалансировать производительность запросов и интуитивность использования для пользователей. Критически важным первым шагом является определение гранулярности данных, которую я бы установил на самом низком атомарном уровне — обычно это отдельная строка транзакции — чтобы обеспечить максимальную аналитическую гибкость для будущих требований. В центральной таблице фактов будут храниться аддитивные показатели, такие как валовая выручка, чистая выручка и количество проданных товаров, а внешние ключи будут поддерживать связи с согласованными измерениями, такими как дата, продукт, клиент и территория продаж. Разделение количественных фактов и качественного контекста позволяет этой архитектуре поддерживать все, от высокоуровневых сводок для руководителей до детального анализа, без необходимости сложной реструктуризации схемы в дальнейшем.
> - Что касается загрузки и актуальности данных, хранилище данных будет получать информацию из основных транзакционных систем организации, таких как ERP или CRM, через конвейер ETL. Хотя частота обновлений строго определяется требованиями бизнеса к задержке данных, я обычно рекомендую ежедневную инкрементальную пакетную загрузку для стандартных стратегических панелей управления, чтобы сбалансировать актуальность данных и производительность системы. Однако, если заинтересованные стороны требуют оперативного мониторинга в течение дня, я бы рекомендовал микропакетную обработку каждые 15 минут. Независимо от частоты, крайне важно реализовать логику очистки и проверки данных в промежуточной области, чтобы обрабатывать проблемы целостности ссылок или нулевые значения до того, как данные будут перенесены в производственное хранилище, гарантируя, что отдел продаж будет доверять точности данных на панели управления.
> - Для получения необходимых KPI за определенный период времени я бы создал скрипт на языке структурированных запросов (SQL), использующий агрегатные функции и объединения. Запрос начинался бы с оператора SELECT, определяющего группирующие измерения, такие как P.Category или T.Region, за которым следовали бы необходимые метрики, определенные как SUM(F.SalesAmount) AS TotalRevenue и COUNT(DISTINCT F.OrderID) AS TransactionVolume. Я бы указал источник с помощью FROM FactSales F и выполнил бы операции INNER JOIN для соединения таблиц измерений — например, JOIN DimDate D ON F.DateKey = D.DateKey. Чтобы выделить конкретный запрошенный период, я бы применил условие WHERE, например, WHERE D.FullDate BETWEEN '2023-01-01' AND '2023-03-31', и, наконец, я бы обеспечил правильный расчет агрегаций, завершив запрос оператором GROUP BY, содержащим все неагрегированные столбцы, указанные в списке SELECT.